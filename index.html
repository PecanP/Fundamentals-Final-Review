<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Fundamentals Final Review — 60 Unique Scenario Questions</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body { margin: 0; background: #0b1020; color: #e9eefc; }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 16px; }
    .card { background:#121a33; border:1px solid #22305e; border-radius:14px; padding:14px; box-shadow:0 10px 30px rgba(0,0,0,.25); }
    h1 { margin: 0 0 6px; font-size: 18px; }
    .muted { color:#a9b6e8; }
    .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .pill { background:#0f1730; border:1px solid #22305e; padding:6px 10px; border-radius:999px; font-size:12px; color:#c7d2ff; }
    .btn { appearance:none; border:1px solid #2a3a76; background:#1a2550; color:#e9eefc; padding:10px 12px; border-radius:10px; cursor:pointer; font-weight:650; }
    .btn.secondary { background:#0f1730; }
    .btn.good { border-color:#2a7a4f; background:#153a2b; }
    .btn:disabled { opacity:.5; cursor:not-allowed; }
    .hr { height:1px; background:#22305e; margin:12px 0; }
    .qtext { font-size: 16px; line-height: 1.35; margin: 10px 0; }
    .opts { display:grid; gap:10px; margin-top:10px; }
    label.opt { display:flex; gap:10px; align-items:flex-start; background:#0f1730; border:1px solid #22305e; border-radius:12px; padding:10px 12px; cursor:pointer; }
    label.opt:hover { border-color:#3a54b0; }
    input[type="radio"], input[type="checkbox"] { margin-top:2px; transform: scale(1.15); }
    .inputbox { width: 320px; max-width: 100%; background:#0f1730; border:1px solid #22305e; border-radius:10px; color:#e9eefc; padding:10px 12px; font-size:16px; }
    .feedback { margin-top:12px; padding:12px; border-radius:12px; border:1px solid #22305e; background:#0f1730; }
    .feedback.good { border-color:#2a7a4f; }
    .feedback.bad { border-color:#8a2d2d; }
    .tag { display:inline-block; font-size:11px; padding:3px 8px; border-radius:999px; border:1px solid #22305e; color:#c7d2ff; margin-right:6px; }
    .tiny { font-size:12px; color:#a9b6e8; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" id="app"></div>
    <div class="tiny" style="margin-top:12px;">
      This exam always uses the same 60-question bank, but it shuffles the order. There are <strong>no duplicate questions inside the exam</strong>.
    </div>
  </div>

<script>
/* =========================
   60 UNIQUE QUESTIONS (no duplicates)
   Types:
   - single (MCQ)
   - sata (select all that apply)
   - numeric (calculations)
   ========================= */

const QUESTIONS = [
  // ----- Medication Math / Safety (8) -----
  {id:1,type:"numeric",topic:"Dosage Calc",
   prompt:"A 52-year-old patient weighs 220 lb and is diagnosed with a new DVT. Order: enoxaparin 1 mg/kg subcut q12h. Round to the nearest whole mg. What is the single dose (mg)?",
   ansN:{v:100,t:0}, rat:"220 ÷ 2.2 = 100 kg. 1 mg/kg → 100 mg per dose."},

  {id:2,type:"numeric",topic:"Dosage Calc",
   prompt:"Order: cefazolin 0.3 g IM now. Vial after reconstitution is 250 mg/mL. Round to the nearest tenth. How many mL will you give?",
   ansN:{v:1.2,t:0.05}, rat:"0.3 g = 300 mg. 300 ÷ 250 = 1.2 mL."},

  {id:3,type:"numeric",topic:"Dosage Calc",
   prompt:"Order: morphine 6 mg IV push. Supply: 10 mg/mL. Round to the nearest tenth. How many mL will you administer?",
   ansN:{v:0.6,t:0.05}, rat:"6 ÷ 10 = 0.6 mL."},

  {id:4,type:"numeric",topic:"Dosage Calc",
   prompt:"Order: heparin 5,000 units subcut. Supply: 10,000 units/mL. Round to the nearest tenth. How many mL will you administer?",
   ansN:{v:0.5,t:0.05}, rat:"5000 ÷ 10000 = 0.5 mL."},

  {id:5,type:"single",topic:"Medication Safety",
   prompt:"You are about to administer meds to a patient in bed 12. Which action best confirms you have the correct patient?",
   options:["Ask the patient to state their name and compare name/DOB on wristband to the MAR","Verify the room number on the door matches the MAR","Ask the family member to confirm identity","Match the patient’s face to the chart photo only"],
   ans:0, rat:"Use two identifiers (e.g., name + DOB/MRN) and match to wristband/MAR. Room number isn’t an identifier."},

  {id:6,type:"sata",topic:"Medication Safety",
   prompt:"A nurse is preparing medications at the bedside. Which actions reflect safe medication practice? (Select all that apply.)",
   options:["Compare the medication label with the MAR at the bedside","Use two identifiers before giving any medication","Crush an enteric-coated tablet to help the patient swallow","Document the medication as given before entering the room","Clarify any unclear order with the prescriber/pharmacy"],
   ans:[0,1,4], rat:"Safe practice includes bedside label/MAR check, 2 identifiers, and clarifying unclear orders. Don’t crush enteric-coated meds; chart after administering."},

  {id:7,type:"single",topic:"Medication Forms",
   prompt:"A patient cannot swallow tablets and has an order for an enteric-coated medication. What should the nurse do?",
   options:["Crush it and mix with applesauce","Split the tablet and crush half","Hold the dose and request an alternate form from provider/pharmacy","Dissolve the tablet in hot water"],
   ans:2, rat:"Enteric-coated/extended-release meds should not be crushed. Request an alternative formulation."},

  {id:8,type:"single",topic:"Adverse/Allergic Reaction",
   prompt:"Ten minutes after receiving a first dose of a new antibiotic, the patient reports throat tightness and you hear wheezing. What is the priority action?",
   options:["Reassure the patient and recheck in 30 minutes","Stop the medication, assess airway/breathing, and initiate emergency response per policy","Document the finding and notify the provider at the end of med pass","Offer oral fluids and deep breathing"],
   ans:1, rat:"Possible anaphylaxis: stop exposure, manage ABCs, call for emergency help per protocol."},

  // ----- Oxygenation / Respiratory (8) -----
  {id:9,type:"single",topic:"Respiratory Mechanics",
   prompt:"When a patient inhales normally, which change allows air to flow into the lungs?",
   options:["Diaphragm contracts → thoracic volume increases → intrapulmonary pressure decreases","Diaphragm relaxes → thoracic volume decreases → intrapulmonary pressure decreases","Ribs move inward → thoracic volume decreases → pressure decreases","Intercostals relax → thoracic volume increases → pressure increases"],
   ans:0, rat:"Inhalation: diaphragm contracts down → volume ↑ → pressure ↓ → air in."},

  {id:10,type:"sata",topic:"Early Hypoxia",
   prompt:"A post-op patient becomes restless and says, “I can’t catch my breath.” Which findings are consistent with early hypoxia? (Select all that apply.)",
   options:["New confusion","Respiratory rate increases from 16 to 26","Cyanosis of lips","Irritability/agitation","Heart rate drops from 84 to 56"],
   ans:[0,1,3], rat:"Early hypoxia: restlessness/irritability, confusion, tachypnea (often tachycardia). Cyanosis/bradycardia are later signs."},

  {id:11,type:"single",topic:"Oxygen Devices",
   prompt:"A patient needs a controlled, precise FiO₂ because of CO₂ retention risk. Which device is most appropriate?",
   options:["Nasal cannula","Venturi mask","Simple face mask","Nonrebreather mask"],
   ans:1, rat:"Venturi mask provides the most precise FiO₂."},

  {id:12,type:"single",topic:"Incentive Spirometer",
   prompt:"Which patient statement indicates incorrect incentive spirometer technique?",
   options:["“I exhale normally first.”","“I inhale slowly to raise the indicator.”","“I hold my breath for a few seconds.”","“I blow into it hard to raise the ball.”"],
   ans:3, rat:"Incentive spirometry is slow deep inhalation, not forceful exhalation."},

  {id:13,type:"single",topic:"Priority (ABCs)",
   prompt:"Four patients call at once. Who should the nurse assess first?",
   options:["Patient requesting pain medication for 6/10 incisional pain","Patient with sudden shortness of breath and new wheezing","Patient asking for assistance to the bathroom","Stable patient with mild nausea after breakfast"],
   ans:1, rat:"ABCs: acute breathing compromise takes priority."},

  {id:14,type:"single",topic:"Respiratory Assessment",
   prompt:"A patient is speaking in 2–3 word phrases with accessory muscle use. What is the nurse’s best interpretation?",
   options:["Normal post-op anxiety","Increased work of breathing requiring prompt intervention","Pain medication side effect only","Expected after ambulation; no action needed"],
   ans:1, rat:"Short phrases + accessory muscle use indicates respiratory distress → intervene promptly."},

  {id:15,type:"single",topic:"Oxygenation",
   prompt:"A patient’s SpO₂ drops to 88% on room air and RR is 30 with visible retractions. What is the best first nursing action?",
   options:["Notify provider after completing shift assessment","Apply oxygen per protocol and reassess","Give oral fluids","Encourage the patient to sleep"],
   ans:1, rat:"Provide oxygen per protocol and reassess—treat hypoxia promptly."},

  {id:16,type:"single",topic:"Documentation",
   prompt:"Which note is best practice documentation for dyspnea after ambulation?",
   options:["“Patient complained of SOB.”","“Patient is hypoxemic after walking.”","“Dyspnea noted after ambulating 15 feet; RR 28; speaking in 2–3 word phrases.”","“Patient exaggerating symptoms.”"],
   ans:2, rat:"Objective, specific, measurable. Avoid diagnoses and judgment."},

  // ----- Fluids & Electrolytes (8) -----
  {id:17,type:"sata",topic:"Fluid Volume Deficit",
   prompt:"A patient with vomiting/diarrhea is dizzy when standing. Which findings support fluid volume deficit? (Select all that apply.)",
   options:["Decreased urine output","Dry mucous membranes","Orthostatic hypotension","Crackles in lung bases","Jugular venous distention"],
   ans:[0,1,2], rat:"FVD: low UO, dry mucosa, orthostatic hypotension. Crackles/JVD suggest excess."},

  {id:18,type:"sata",topic:"Fluid Volume Excess",
   prompt:"A patient with heart failure reports worsening shortness of breath. Which findings suggest fluid volume excess? (Select all that apply.)",
   options:["Weight gain over 48 hours","Crackles on auscultation","Flat neck veins","Ankle edema","Dry mucous membranes"],
   ans:[0,1,3], rat:"FVE: weight gain, crackles, edema (often JVD/HTN). Flat neck veins/dry mucosa suggest deficit."},

  {id:19,type:"single",topic:"Electrolytes",
   prompt:"A patient reports tingling around the mouth and muscle cramps after thyroid surgery. Which imbalance is most likely?",
   options:["Hypokalemia","Hypocalcemia","Hypernatremia","Hypermagnesemia"],
   ans:1, rat:"Post-thyroid surgery can lower calcium; paresthesias/tetany point to hypocalcemia."},

  {id:20,type:"single",topic:"Electrolytes",
   prompt:"A patient with kidney failure has ECG changes described as peaked T waves. Which imbalance is most likely?",
   options:["Hyperkalemia","Hypokalemia","Hyponatremia","Hypocalcemia"],
   ans:0, rat:"Peaked T waves are classic for hyperkalemia."},

  {id:21,type:"single",topic:"Priority (Perfusion)",
   prompt:"A dehydrated patient is dizzy. Which finding is most concerning?",
   options:["Thirst","Dry lips","Systolic BP 84 with dizziness","Poor skin turgor"],
   ans:2, rat:"Hypotension with symptoms indicates poor perfusion/shock risk."},

  {id:22,type:"single",topic:"Fluid Balance",
   prompt:"Which assessment is most sensitive for detecting short-term fluid changes in hospitalized adults?",
   options:["Daily weights","Skin turgor","Blood pressure only","Capillary refill"],
   ans:0, rat:"Daily weights are the best indicator of short-term fluid gain/loss."},

  {id:23,type:"single",topic:"Intake & Output",
   prompt:"A patient’s urine output is 20 mL/hr for 3 hours. Which is the best nursing action?",
   options:["Document and reassess next shift","Encourage fluids if not contraindicated and assess for hypovolemia/obstruction","Give diuretic immediately","Remove catheter tubing to ‘improve flow’"],
   ans:1, rat:"Low UO needs assessment for causes and early intervention; don’t break closed systems."},

  {id:24,type:"single",topic:"Electrolytes/Sodium",
   prompt:"A patient with hyponatremia becomes acutely confused and has a seizure. What is the priority action?",
   options:["Place in Trendelenburg position","Protect airway and initiate seizure precautions; notify provider","Give a large glass of water","Ambulate to decrease confusion"],
   ans:1, rat:"ABCs + safety: protect airway and manage seizure; urgent escalation."},

  // ----- Infection Control (6) -----
  {id:25,type:"single",topic:"Hand Hygiene",
   prompt:"A patient is on contact precautions for C. difficile. Which is required after removing gloves and leaving the room?",
   options:["Alcohol-based hand sanitizer only","Soap and water handwashing","No hand hygiene if gloves were worn","Double-gloving next time"],
   ans:1, rat:"C. diff spores require soap and water."},

  {id:26,type:"single",topic:"PPE",
   prompt:"Which is the most common PPE removal sequence (follow facility policy)?",
   options:["Mask → gown → gloves → goggles","Gloves → gown → goggles/face shield → mask","Gown → gloves → mask → goggles","Goggles → mask → gown → gloves"],
   ans:1, rat:"Common removal order: gloves, gown, goggles/face shield, mask."},

  {id:27,type:"single",topic:"Standard Precautions",
   prompt:"Standard precautions should be used:",
   options:["Only for patients with known infection","For all patients regardless of diagnosis","Only during invasive procedures","Only when blood is visible"],
   ans:1, rat:"Standard precautions apply to all patients."},

  {id:28,type:"single",topic:"Sharps Safety",
   prompt:"After giving an injection, what is the best practice for needle disposal?",
   options:["Recap using two hands, then dispose","Recap using one hand scoop technique","Do not recap; activate safety device and place directly in sharps container","Carry it to the medication room before discarding"],
   ans:2, rat:"Do not recap; use safety device and dispose immediately in sharps container."},

  {id:29,type:"single",topic:"Transmission Precautions",
   prompt:"A patient with suspected tuberculosis is admitted. What is the priority isolation requirement?",
   options:["Contact precautions","Droplet precautions","Airborne precautions with negative-pressure room","No precautions needed until confirmed"],
   ans:2, rat:"TB requires airborne precautions and negative pressure (per policy)."},

  {id:30,type:"single",topic:"Asepsis",
   prompt:"During sterile dressing change, a sterile glove touches the bed rail. What is the best action?",
   options:["Continue; bed rails are ‘clean enough’","Apply hand sanitizer and continue","Replace the contaminated glove and re-establish sterility","Cover the glove with gauze and continue"],
   ans:2, rat:"Contamination breaks sterility; replace and continue with sterile technique."},

  // ----- Mobility / Safety / Skin (8) -----
  {id:31,type:"single",topic:"Falls",
   prompt:"While ambulating, a patient becomes dizzy and begins to fall. What is the best immediate nursing action?",
   options:["Hold the patient upright to prevent falling","Lower the patient to the floor and protect the head","Leave to get help immediately","Pull the patient back toward the bed quickly"],
   ans:1, rat:"Guide to floor, protect head, call for help, then assess."},

  {id:32,type:"single",topic:"Restraints",
   prompt:"A confused patient repeatedly pulls at IV tubing. Which intervention is most appropriate first?",
   options:["Apply restraints immediately","Use frequent rounding, reorientation, and move items within reach; consider sitter/alarms per policy","Raise all 4 side rails","Place call light out of reach"],
   ans:1, rat:"Use least restrictive interventions first; restraints are last resort and require policy/monitoring."},

  {id:33,type:"single",topic:"Pressure Injury",
   prompt:"An immobile patient has nonblanchable redness over the sacrum with intact skin. This is most consistent with:",
   options:["Stage 1 pressure injury","Stage 2 pressure injury","Stage 3 pressure injury","Skin tear"],
   ans:0, rat:"Stage 1 = nonblanchable erythema with intact skin."},

  {id:34,type:"single",topic:"Pressure Injury",
   prompt:"A shallow open blister on the heel with a pink wound bed is most consistent with:",
   options:["Stage 1","Stage 2","Stage 3","Stage 4"],
   ans:1, rat:"Stage 2 = partial-thickness loss (blister/shallow open ulcer)."},

  {id:35,type:"sata",topic:"Pressure Injury Prevention",
   prompt:"Which interventions reduce pressure injury risk for an immobile patient? (Select all that apply.)",
   options:["Turn/reposition on a schedule","Float heels off the bed","Massage reddened bony prominences vigorously","Use moisture barrier for incontinence","Keep head of bed as low as tolerated to reduce shear"],
   ans:[0,1,3,4], rat:"Reposition, float heels, manage moisture, reduce shear; do not massage reddened areas."},

  {id:36,type:"single",topic:"Safe Transfers",
   prompt:"Before transferring a weak patient from bed to chair, what should the nurse do first?",
   options:["Ask the patient to stand quickly to ‘test strength’","Lock the bed and wheelchair/chair, and ensure non-skid footwear","Place the chair far from the bed to encourage walking","Tell the patient to hold their breath while standing"],
   ans:1, rat:"Safety setup first: lock equipment, non-skid footwear, proper positioning."},

  {id:37,type:"single",topic:"Neurovascular Check",
   prompt:"A patient has a cast placed for a fracture. Which finding requires immediate notification?",
   options:["Itching under the cast","New numbness/tingling and pain unrelieved by medication","Warm toes with brisk capillary refill","Mild swelling expected after injury"],
   ans:1, rat:"Neurovascular compromise (pain, paresthesia) is an emergency."},

  {id:38,type:"single",topic:"Wound Drainage",
   prompt:"A surgical dressing has new bright-red drainage soaking through. What is the priority action?",
   options:["Reinforce the dressing and document; recheck later","Mark the drainage outline/time, assess vitals, and notify provider if increasing/unstable","Remove the dressing to inspect the incision fully","Ignore; this is expected post-op"],
   ans:1, rat:"Assess bleeding and stability; mark/monitor; escalate if worsening."},

  // ----- Elimination (4) -----
  {id:39,type:"single",topic:"CAUTI Prevention",
   prompt:"A patient has a Foley catheter. Which action best reduces CAUTI risk?",
   options:["Disconnect tubing to empty faster","Maintain a closed system and secure catheter to the thigh","Keep the drainage bag above bladder level","Irrigate the catheter every shift"],
   ans:1, rat:"Closed system + securement + dependent drainage reduce infection risk."},

  {id:40,type:"single",topic:"Constipation",
   prompt:"A patient on opioids reports no bowel movement in 3 days. Which teaching is most appropriate?",
   options:["Decrease fluids to prevent bloating","Increase fiber/fluids as allowed and use stool softener/laxative as ordered","Avoid walking to conserve energy","Stop all laxatives permanently"],
   ans:1, rat:"Opioids cause constipation; prevention includes fluids, fiber, activity, and ordered meds."},

  {id:41,type:"single",topic:"Urinary Retention",
   prompt:"A post-op patient has not voided in 8 hours and reports suprapubic fullness. What should the nurse do first?",
   options:["Document and reassess later","Assess bladder distention and perform bladder scan per protocol","Restrict fluids to prevent overfilling","Give a diuretic"],
   ans:1, rat:"Assess for retention and follow protocol (scan/straight cath order if indicated)."},

  {id:42,type:"single",topic:"Bowel Assessment",
   prompt:"A patient reports black, tarry stools. What is the nurse’s best initial action?",
   options:["Reassure; it is normal with constipation","Assess for GI bleeding risk and notify provider; check vitals","Administer an enema immediately","Encourage foods high in iron only"],
   ans:1, rat:"Melena suggests GI bleeding; assess stability and escalate."},

  // ----- Nutrition (4) -----
  {id:43,type:"single",topic:"Nutrition",
   prompt:"A patient has unintentionally lost 12 lb in 2 months and has poor appetite. Which finding best supports malnutrition risk?",
   options:["BMI of 27","Unintentional weight loss","High HDL","Thick hair texture"],
   ans:1, rat:"Unintentional weight loss is a strong malnutrition indicator."},

  {id:44,type:"single",topic:"Aspiration Precautions",
   prompt:"A patient with dysphagia coughs during liquids. Which nursing action best reduces aspiration risk?",
   options:["Offer thin liquids quickly","Keep patient supine for comfort","Position upright and follow speech/texture recommendations","Place food in the back of the mouth"],
   ans:2, rat:"Upright positioning and texture modifications reduce aspiration risk."},

  {id:45,type:"single",topic:"Diabetes Safety",
   prompt:"A diabetic patient becomes diaphoretic, shaky, and confused. What is the best first action if the patient can swallow?",
   options:["Give rapid-acting carbohydrate and recheck glucose","Administer long-acting insulin","Encourage walking to ‘burn sugar’","Call dietary for a low-sugar tray"],
   ans:0, rat:"Treat suspected hypoglycemia immediately (fast carbs) then recheck."},

  {id:46,type:"single",topic:"Nutrition Support",
   prompt:"A patient on tube feeds has abdominal distention and nausea. What is the best nursing action?",
   options:["Increase the feeding rate","Stop the feeding temporarily and assess tolerance per protocol; notify provider as indicated","Ignore; distention is expected","Flush with 200 mL immediately regardless of orders"],
   ans:1, rat:"Assess intolerance and follow protocol (hold/notify). Don’t increase rate."},

  // ----- Pain / Sleep (4) -----
  {id:47,type:"single",topic:"Pain Assessment",
   prompt:"A patient is grimacing but states pain is 2/10 and refuses medication. What is the best nursing action?",
   options:["Document 2/10 and end assessment","Give analgesic anyway because grimacing means severe pain","Complete focused pain assessment and ask for the patient’s comfort goal","Notify provider immediately"],
   ans:2, rat:"Pain is subjective. Assess thoroughly and align care to patient’s goal."},

  {id:48,type:"single",topic:"Pain Reassessment",
   prompt:"After IV opioid administration, when should the nurse reassess pain effectiveness (typical)?",
   options:["Immediately","Within about 15–30 minutes","In 2 hours","Next shift"],
   ans:1, rat:"IV opioids act quickly; reassess within ~15–30 minutes per policy."},

  {id:49,type:"single",topic:"Nonpharmacologic Pain",
   prompt:"Which intervention best aligns with gate-control theory for pain reduction?",
   options:["Strict bedrest only","Heat/cold therapy or TENS","NPO status","Limiting family visitation"],
   ans:1, rat:"Heat/cold, massage, and TENS can reduce pain transmission (gate control)."},

  {id:50,type:"single",topic:"Sleep",
   prompt:"A hospitalized patient reports poor sleep. Which intervention is best first?",
   options:["Schedule all care at midnight","Cluster care to minimize nighttime interruptions","Encourage 4–5 hours daytime napping","Increase caffeine with meals"],
   ans:1, rat:"Clustering care reduces interruptions and supports restorative sleep."},

  // ----- Teaching / Communication (4) -----
  {id:51,type:"single",topic:"Teaching",
   prompt:"A patient is learning insulin self-injection. Which method best confirms learning?",
   options:["Ask “Do you understand?”","Teach-back with return demonstration","Provide a long pamphlet and leave","Ask family if they understand"],
   ans:1, rat:"Return demonstration is the best way to confirm skill learning."},

  {id:52,type:"single",topic:"Readiness to Learn",
   prompt:"A patient is scheduled for discharge teaching but rates pain 9/10 and cannot focus. Best action?",
   options:["Proceed quickly because discharge is today","Postpone teaching until pain is better controlled","Teach complex topics first","Ask patient to sign the teaching form"],
   ans:1, rat:"Address barriers first (pain/readiness) to make teaching effective."},

  {id:53,type:"single",topic:"Therapeutic Communication",
   prompt:"A patient says, “I’m scared about my surgery tomorrow.” Which response is most therapeutic?",
   options:["“Don’t worry, you’ll be fine.”","“Everyone feels that way.”","“Tell me what worries you most.”","“Let’s focus on your vitals now.”"],
   ans:2, rat:"Open-ended exploration helps assess concerns and provides support."},

  {id:54,type:"single",topic:"Interpreter",
   prompt:"A patient with limited English nods but appears confused during teaching. Best action?",
   options:["Speak louder and slower","Use the adult child to interpret sensitive topics","Request a qualified medical interpreter","Provide written materials in English only"],
   ans:2, rat:"Qualified interpreters improve accuracy, safety, and consent/teaching quality."},

  // ----- Ethics / End-of-Life / Culture (6) -----
  {id:55,type:"single",topic:"Ethics",
   prompt:"A competent patient refuses a blood transfusion for religious reasons after risks are explained. Which principle is primarily being respected?",
   options:["Beneficence","Autonomy","Justice","Nonmaleficence"],
   ans:1, rat:"Autonomy: the right of a competent patient to choose/refuse."},

  {id:56,type:"single",topic:"Informed Consent",
   prompt:"Right before signing consent, a patient says, “I don’t understand what this procedure is for.” What should the nurse do?",
   options:["Witness the signature anyway","Explain risks/benefits in detail and obtain the signature","Stop and notify the provider to re-explain","Tell the patient to sign and ask later"],
   ans:2, rat:"The provider must explain; the nurse stops and requests clarification."},

  {id:57,type:"single",topic:"Hospice",
   prompt:"Which statement best describes hospice care?",
   options:["Focuses on cure at any cost","Focuses on comfort and quality of life","Only provided in hospitals","Requires stopping all medications immediately"],
   ans:1, rat:"Hospice prioritizes comfort and quality of life; meds may continue for symptom control."},

  {id:58,type:"single",topic:"End-of-Life Comfort",
   prompt:"A hospice patient requests pain medication more frequently. Family fears addiction. Best response?",
   options:["“We should avoid opioids to prevent addiction.”","“Addiction is not the priority at end-of-life; comfort is.”","“We will only medicate if the family agrees.”","“Relaxation only—no medication.”"],
   ans:1, rat:"End-of-life care prioritizes comfort; addiction is not the main concern."},

  {id:59,type:"single",topic:"Cultural/Spiritual Care",
   prompt:"A family requests a brief religious ritual before postmortem care begins. Best nursing action?",
   options:["Proceed immediately with postmortem care","Accommodate the ritual when possible and provide privacy","Explain rituals are not allowed","Call security to remove family"],
   ans:1, rat:"Provide culturally/spiritually competent care when possible within policy and safety."},

  {id:60,type:"single",topic:"Legal/Safety",
   prompt:"A nurse realizes a medication error occurred (wrong dose given). What is the priority action?",
   options:["Complete an incident report first","Assess the patient and notify provider/charge nurse per policy","Hide the error to avoid consequences","Wait to see if symptoms develop"],
   ans:1, rat:"Patient safety first: assess, notify appropriate parties, then follow reporting process."},
];

// ---------- No-repeat guarantee inside an exam run ----------
function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
function arraysEqual(a,b){ if(a.length!==b.length) return false; for(let i=0;i<a.length;i++) if(a[i]!==b[i]) return false; return true; }
function esc(s){
  return String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")
                  .replaceAll('"',"&quot;").replaceAll("'","&#039;");
}

const state = { order: [], idx: 0, answers: new Map(), timerOn:false, timerSec:0, tick:null, startTs:null };

function renderStart(){
  const app = document.getElementById("app");
  app.innerHTML = `
    <h1>Fundamentals Final Review — 60 Unique Scenario Questions</h1>
    <div class="muted">Scenario-based • MCQ + SATA + calculations • Rationales • <strong>No duplicates inside the exam</strong></div>
    <div class="hr"></div>
    <div class="row">
      <button class="btn good" id="startShuf">Start (Shuffled)</button>
      <button class="btn secondary" id="startOrd">Start (In Order)</button>
      <button class="btn" id="startTimed">Start Timed (75 min)</button>
      <span class="pill" id="timer"></span>
    </div>
    <div class="hr"></div>
    <div class="tiny">Numeric: enter a number only. SATA is all-or-nothing (typical exam scoring).</div>
  `;
  document.getElementById("startShuf").onclick = ()=>startExam(true,false,75);
  document.getElementById("startOrd").onclick  = ()=>startExam(false,false,75);
  document.getElementById("startTimed").onclick= ()=>startExam(true,true,75);
}

function startExam(shuffleOrder=true, timed=false, minutes=75){
  // EXACTLY ONCE each question id 1..60
  state.order = QUESTIONS.map(q=>q.id);
  if(shuffleOrder) state.order = shuffle(state.order);

  state.idx = 0;
  state.answers.clear();
  state.startTs = Date.now();

  state.timerOn = timed;
  state.timerSec = minutes*60;
  if(state.tick) clearInterval(state.tick);
  if(timed){
    state.tick = setInterval(()=>{
      state.timerSec--;
      if(state.timerSec<=0){
        clearInterval(state.tick);
        renderResults();
      } else renderTimer();
    },1000);
  }
  renderQuestion();
}

function renderTimer(){
  const el = document.getElementById("timer");
  if(!el) return;
  if(!state.timerOn){ el.textContent=""; return; }
  const m = Math.floor(state.timerSec/60);
  const s = state.timerSec%60;
  el.textContent = `Time: ${m}:${String(s).padStart(2,"0")}`;
}

function getQ(){
  const id = state.order[state.idx];
  return QUESTIONS.find(q=>q.id===id);
}

function formatCorrect(q){
  if(q.type==="single") return q.options[q.ans];
  if(q.type==="sata") return q.ans.map(i=>q.options[i]).join("; ");
  if(q.type==="numeric") return String(q.ansN.v);
  return "";
}

function grade(q){
  if(q.type==="single"){
    const c = document.querySelector('input[type="radio"][name="opt"]:checked');
    const user = c ? Number(c.value) : null;
    return { user, correct: user===q.ans, correctAnswer:q.ans };
  }
  if(q.type==="sata"){
    const picked = Array.from(document.querySelectorAll('input[type="checkbox"][name="opt"]:checked'))
      .map(x=>Number(x.value)).sort((a,b)=>a-b);
    const key = q.ans.slice().sort((a,b)=>a-b);
    return { user:picked, correct: arraysEqual(picked,key), correctAnswer:key };
  }
  if(q.type==="numeric"){
    const raw = document.getElementById("numInput").value.trim();
    const v = Number(raw);
    const key = q.ansN.v;
    const tol = q.ansN.t ?? 0;
    const correct = Number.isFinite(v) && Math.abs(v-key) <= tol;
    return { user: raw, correct, correctAnswer: key };
  }
}

function lockInputs(q){
  if(q.type==="numeric") document.getElementById("numInput").disabled = true;
  else document.querySelectorAll('input[name="opt"]').forEach(x=>x.disabled=true);
}

function restore(q, user){
  if(q.type==="numeric"){
    document.getElementById("numInput").value = user ?? "";
  } else if(q.type==="single"){
    const el = document.querySelector(`input[type="radio"][name="opt"][value="${user}"]`);
    if(el) el.checked = true;
  } else {
    (user||[]).forEach(i=>{
      const el = document.querySelector(`input[type="checkbox"][name="opt"][value="${i}"]`);
      if(el) el.checked = true;
    });
  }
}

function renderQuestion(){
  const q = getQ();
  const app = document.getElementById("app");
  const progress = `${state.idx+1} / ${state.order.length}`;

  let html = `
    <div class="row" style="justify-content:space-between;">
      <div class="row">
        <span class="pill">Question ${progress}</span>
        <span class="pill">${esc(q.topic)}</span>
        <span class="pill" id="timer"></span>
      </div>
      <button class="btn secondary" id="endBtn">End & Score</button>
    </div>
    <div class="qtext"><strong>${esc(q.prompt)}</strong></div>
  `;

  if(q.type==="single" || q.type==="sata"){
    const t = q.type==="single" ? "radio" : "checkbox";
    html += `<div class="opts" id="opts">`;
    q.options.forEach((opt,i)=>{
      html += `<label class="opt"><input type="${t}" name="opt" value="${i}"><div>${esc(opt)}</div></label>`;
    });
    html += `</div>`;
  } else {
    html += `
      <div class="row">
        <input class="inputbox mono" id="numInput" inputmode="decimal" placeholder="Enter number only (no units)" />
      </div>
      <div class="tiny" style="margin-top:6px;">Follow the rounding instruction in the stem.</div>
    `;
  }

  html += `
    <div class="hr"></div>
    <div class="row" style="justify-content:space-between;">
      <button class="btn secondary" id="prevBtn" ${state.idx===0?"disabled":""}>Back</button>
      <div class="row">
        <button class="btn" id="checkBtn" disabled>Check</button>
        <button class="btn good" id="nextBtn" disabled>Next</button>
      </div>
    </div>
    <div id="fbSlot"></div>
  `;

  app.innerHTML = html;
  renderTimer();

  document.getElementById("endBtn").onclick = ()=>renderResults();
  document.getElementById("prevBtn").onclick = ()=>{ state.idx--; renderQuestion(); };

  const checkBtn = document.getElementById("checkBtn");
  const nextBtn  = document.getElementById("nextBtn");

  function enableCheck(){
    let answered = false;
    if(q.type==="single") answered = !!document.querySelector('input[type="radio"][name="opt"]:checked');
    else if(q.type==="sata") answered = document.querySelectorAll('input[type="checkbox"][name="opt"]:checked').length>0;
    else answered = document.getElementById("numInput").value.trim().length>0;
    checkBtn.disabled = !answered;
  }

  if(q.type==="numeric") document.getElementById("numInput").addEventListener("input", enableCheck);
  else document.getElementById("opts").addEventListener("change", enableCheck);

  checkBtn.onclick = ()=>{
    const res = grade(q);
    state.answers.set(q.id, res);
    showFeedback(q, res);
    lockInputs(q);
    checkBtn.disabled = true;
    nextBtn.disabled = false;
  };

  nextBtn.onclick = ()=>{
    if(state.idx < state.order.length-1){ state.idx++; renderQuestion(); }
    else renderResults();
  };

  const existing = state.answers.get(q.id);
  if(existing){
    restore(q, existing.user);
    lockInputs(q);
    showFeedback(q, existing);
    checkBtn.disabled = true;
    nextBtn.disabled = false;
  }
}

function showFeedback(q, res){
  const slot = document.getElementById("fbSlot");
  const cls = res.correct ? "good" : "bad";
  let correctLine = "";
  if(!res.correct){
    correctLine = `<div class="tiny"><span class="tag">Correct</span>${esc(formatCorrect(q))}</div>`;
  }
  slot.innerHTML = `
    <div class="feedback ${cls}">
      <div><strong>${res.correct ? "Correct" : "Incorrect"}</strong></div>
      ${correctLine}
      <div class="tiny" style="margin-top:6px;"><span class="tag">Rationale</span>${esc(q.rat)}</div>
    </div>
  `;
}

function renderResults(){
  if(state.tick) clearInterval(state.tick);

  const total = state.order.length;
  let correct = 0;
  const missed = [];
  state.order.forEach(id=>{
    const res = state.answers.get(id);
    if(res && res.correct) correct++;
    else missed.push(id);
  });

  const pct = Math.round((correct/total)*100);
  const minutesUsed = Math.round((Date.now()-state.startTs)/60000);

  const missedPreview = missed.slice(0,12).map(id=>{
    const q = QUESTIONS.find(x=>x.id===id);
    return `<li><span class="tag">${esc(q.topic)}</span> ${esc(q.prompt)}</li>`;
  }).join("");

  document.getElementById("app").innerHTML = `
    <h1>Results — 60 Unique Scenario Questions</h1>
    <div class="row">
      <span class="pill">Score: <strong>${correct}/${total}</strong> (${pct}%)</span>
      <span class="pill">Missed: ${missed.length}</span>
      <span class="pill">Time used: ${minutesUsed} min</span>
    </div>
    <div class="hr"></div>
    <div class="row">
      <button class="btn good" id="restart">Restart (Shuffled)</button>
      <button class="btn secondary" id="home">Home</button>
    </div>
    <div class="hr"></div>
    <div class="tiny">
      No “retest missed” button on purpose (it repeats questions). If you want a <em>review mode</em> that shows missed rationales without re-asking, I can add it.
    </div>
    <div class="hr"></div>
    <div class="tiny"><strong>Missed question preview (first 12):</strong></div>
    <ol class="tiny">${missedPreview || "<li>None — clean sweep.</li>"}</ol>
  `;

  document.getElementById("restart").onclick = ()=>startExam(true,false,75);
  document.getElementById("home").onclick = ()=>renderStart();
}

renderStart();
</script>
</body>
</html>